{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/js/melangeManager.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","url_actuelle","window","location","protocol","host","pathname","melange_id","$","attr","animal_deja_present","formsubmit","url","getUrl","val","post","data","serialize","done","animal","JSON","parse","updateMelange","id","ligne_in","numero","nom","prepend","ligne_out","updateListeMelange","fail","alert","route","cesure","search","replace","substring","animal_id","addOrdel","datas","console","log","errors","on","numero_nouveau","title","content","theme","type","icon","buttons","OK","btnClass","each","index","this","html","confirm","oui","keys","action","non","focus","children","split","liste_id","parent","fadeOut","fadeIn"],"mappings":"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","file":"/js/melangeManager.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 46);\n","\r\n// GESTION DE LA MODIFICATION DES MELANGES\r\n// Crée un nouvel animal dans un mélange ou ajoute ou retire un animal d'un mélange\r\n// On récupére l'url actuelle\r\nvar url_actuelle = window.location.protocol + \"//\" + window.location.host + window.location.pathname; // récupère l'adresse de la page actuelle\r\n// On récupère l'id du mélange pour la mise à jour\r\nvar melange_id = $(\"#liste-in\").attr('melange');\r\nvar troupeau_id = $('#liste-in').attr('troupeau')\r\n// On initialise la variable à faux\r\nvar animal_deja_present = false\r\n\r\n// Ajout d'un animal\r\n$(\"#add_animal\").on(\"click\", function() {\r\n  var numero_nouveau = $(\"#numero_nouveau\").val();\r\n  var nom_nouveau = $(\"#nom_nouveau\").val();\r\n  // Si le champs numero est vide, on ouvre une alert d'avertissement\r\n  if(numero_nouveau == '') {\r\n\r\n    $.alert({\r\n      title: \"Attention !\",\r\n      content: \"Il faut saisir au moins une valeur dans le champs numéro\",\r\n      theme: 'dark',\r\n      type: 'red',\r\n      icon: 'fas fa-exclamation-triangle',\r\n      buttons: {\r\n        OK: {\r\n          btnClass : 'btn-success',\r\n        }\r\n      }\r\n    });\r\n\r\n  } else {\r\n    // On passe en revue tous les numeros déjà existants\r\n    $('button').each(function(index) {\r\n      if($(this).html().search(numero_nouveau) !== -1) {\r\n        // On passe la variable à vrai\r\n        animal_deja_present = true;\r\n      }\r\n    })\r\n\r\n    // Si le nom saisi est déjà parmi les existants, on fait une alerte\r\n    // qui laisse la choix de l'enregister quand même.\r\n    if(animal_deja_present) {\r\n      $.confirm({\r\n        title: \"Attention !\",\r\n        content: \"Cet animal semble déjà exister, voulez-vous quand même l'enregistrer\",\r\n        theme: 'dark',\r\n        type: 'orange',\r\n        icon: 'fas fa-exclamation-triangle',\r\n        buttons: {\r\n          oui: {\r\n            btnClass: 'btn-blue',\r\n            keys: ['enter'],\r\n            action: function() {\r\n              // Si on veut tout de même l'enregistrer, on soumet le formulaire\r\n              formsubmit();\r\n            }\r\n          },\r\n          non: {\r\n            btnClass: 'btn-secondary',\r\n            keys: ['esc'],\r\n            action:function() {\r\n              $('#numero_nouveau').focus();\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      // On crée le nouvel animal\r\n      formsubmit();\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\n// Met à jour la liste des animaux du mélange dans la BDD puis appelle la fonction\r\n// updateMelange qui met à jour la liste affichée à  l'écran\r\nfunction formsubmit() {\r\n\r\n  url = getUrl('api/melange/addAnimal');\r\n\r\n  $(\"#numero_nouveau\").attr('value', $(\"#numero_nouveau\").val());\r\n\r\n  $.post({\r\n    url: url,\r\n    data: $(\"#form_addAnimal\").serialize()\r\n  })\r\n  .done(function(data) {\r\n    var animal = JSON.parse(data);\r\n    // On met à jour le mélange en ajoutant cet animal dans la bdd (AJAX)\r\n    updateMelange(animal.id, 'addtomelange');\r\n    // On met à jour l'affichage\r\n    updateListeMelange(animal);\r\n\r\n  })\r\n  .fail(function(data) {\r\n    alert('il y a un problème !')\r\n  })\r\n}\r\n\r\n// Ajout ou suppression d'un animal du mélange\r\n// Quand on clique sur un animal\r\n$('.liste-animals').on('click', '.animal-melange', function() {\r\n\r\n  // On récupère le contenu\r\n  var contenu = $(this).html();\r\n  // On récupère le numéro de l'animal\r\n  var contenu_id = $(this).children().attr('id');\r\n  var animal_id = contenu_id.split('_')[1];\r\n  // On récupère l'id de la liste\r\n  var liste_id = $(this).parent().attr('id');\r\n  // On efface la ligne correspondante\r\n  $(this).fadeOut();\r\n  // Si on a cliqué sur un animal hors du mélange\r\n  if(liste_id == \"liste-out\") {\r\n    // On met à jour le mélange en ajoutant cet animal dans la bdd (AJAX)\r\n    updateMelange(animal_id, 'addtomelange');\r\n    // On affiche cette animal dans la liste In\r\n    $(\"#animalIn_\" + animal_id).fadeIn();\r\n    // Si on a cliqué sur un animal dans le mélange\r\n  } else {\r\n    // On l'enlève du mélange dans la BDD (AJAX)\r\n    updateMelange(animal_id, 'deltomelange');\r\n    // On l'affiche dans la liste hors mélange\r\n    $(\"#animalOut_\" + animal_id).fadeIn();\r\n  }\r\n\r\n})\r\n\r\n// Fonction qui renvoie l'url pour la requete AJAX\r\nfunction getUrl(route) {\r\n  // comme les url sont différente en local (avec /public/) et en distant\r\n  // et que il y deux façon de créer un nouvel animal dans un mélange (melange.create et melange.edit)\r\n  // Il faut repérer le position du mot laboratoire et modifier l'url en conséquence\r\n  var cesure = url_actuelle.search('laboratoire');\r\n  // cesure est la position de la lettre l dans l'url actuelle\r\n  // url_actuelle.sustring(cesure) est le fragment d'url à partir du l de laboratoire\r\n  return url_actuelle.replace( url_actuelle.substring(cesure), route);\r\n}\r\n\r\n// Met à jour le mélange dans la base de donnée par une requete ajax\r\n// Si addOrdel = 'addtomelange' c'est un ajout via la méthode DonneesController@addtomelange\r\n// Si addOrdel = 'deltomelange' c'est un retrait via la méthode DonneesController@deltomelange\r\nfunction updateMelange(animal_id, addOrdel) {\r\n\r\n  // Création de l'url de la requete AJAX (addtomelange pour ajout, deltomelange pour retrait)\r\n\r\n  url = getUrl(('api/melange/' + addOrdel));\r\n  // On construit un JSON\r\n  var data = {\r\n    \"melange_id\" : melange_id,\r\n    \"animal_id\" : animal_id\r\n  }\r\n\r\n  // Requete post sur DonneesController@maddtomelange\r\n  $.post({\r\n    url : url,\r\n    data: data,\r\n  })\r\n  .done(function(datas) {\r\n    console.log(\"Ok tout va bien\");\r\n  })\r\n  .fail(function(errors) {\r\n    console.log('ERREURS:' + errors);\r\n  })\r\n\r\n}\r\n\r\n// Met à jour la liste des animaux présents dans le mélange avec le retour ajax\r\n// de la fonction DonneesController@melangeUpdate\r\nfunction updateListeMelange(animal) {\r\n\r\n  // On ajoute une ligne visible dans les animaux du mélange\r\n  var ligne_in =\r\n    '<div id=\"animalIn_' + animal.id +\r\n    '\" class=\"animal-melange in-melange\">' +\r\n    '<button id=\"animal_' + animal.id + '\"' +\r\n    'class=\"m-1 p-3 border btn btn-info text-left w-100\" title=\"' + animal.id +' \">' +\r\n    animal.numero + ' ' + (animal.nom ? animal.nom : '') +\r\n    '</button></div>';\r\n\r\n  $('#liste-in').prepend(ligne_in);\r\n  // Et une ligne cachée dans les animaux hors du mélange\r\n  var ligne_out =\r\n    '<div id=\"animalOut_' + animal.id +\r\n    '\" class=\"animal-melange out-melange collapse\">' +\r\n    '<button id=\"animal_' + animal.id + '\"' +\r\n    'class=\"m-1 p-3 border btn btn-light text-left w-100\" title=\"' + animal.id +' \">' +\r\n    animal.numero + ' ' + (animal.nom ? animal.nom : '') +\r\n    '</button></div>';\r\n\r\n  $('#liste-out').prepend(ligne_out);\r\n}\r\n"],"sourceRoot":""}